<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belly Fat Burn Exercise Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #2E7D32;
            --primary-dark: #1B5E20;
            --secondary: #FF9800;
            --accent: #F44336;
            --light: #F1F8E9;
            --dark: #1A1A1A;
            --gray: #757575;
            --light-gray: #F5F5F5;
        }
        
        html, body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            display: flex;
            flex-direction: column;
        }
        
        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            max-width: 100%;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }
        
        /* Header */
        .header {
            padding: 16px 24px;
            background: white;
            border-bottom: 3px solid var(--primary);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 40px;
            height: 40px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 20px;
        }
        
        .title-container {
            flex: 1;
        }
        
        .title-input {
            width: 100%;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-dark);
            border: none;
            background: transparent;
            padding: 8px 0;
            font-family: inherit;
        }
        
        .title-input:focus {
            outline: none;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-shrink: 0;
        }
        
        .btn {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
        }
        
        .btn-secondary {
            background: var(--secondary);
        }
        
        .btn-secondary:hover {
            background: #F57C00;
        }
        
        .btn-danger {
            background: var(--accent);
        }
        
        .btn-danger:hover {
            background: #D32F2F;
        }
        
        /* Main Content Area */
        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
            background: white;
        }
        
        /* Left Panel - Exercise Dashboard */
        .dashboard-panel {
            width: 350px;
            background: var(--light-gray);
            border-right: 2px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .panel-header {
            padding: 20px;
            background: var(--primary);
            color: white;
            font-size: 18px;
            font-weight: 600;
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        /* Goal Section */
        .goal-section {
            margin-bottom: 30px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .goal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .goal-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .goal-edit-btn {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: color 0.3s;
        }
        
        .goal-edit-btn:hover {
            color: var(--primary-dark);
        }
        
        .goal-text {
            font-size: 14px;
            line-height: 1.5;
            color: var(--dark);
            background: var(--light);
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid var(--secondary);
            min-height: 80px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .goal-text.empty {
            color: var(--gray);
            font-style: italic;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .goal-input {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid var(--primary);
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            margin-bottom: 10px;
        }
        
        .goal-input:focus {
            outline: none;
            border-color: var(--primary-dark);
        }
        
        /* YouTube Playlist Manager */
        .playlist-manager {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: var(--primary);
        }
        
        .yt-input-group {
            margin-bottom: 15px;
        }
        
        .yt-input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 10px;
            transition: border-color 0.3s;
        }
        
        .yt-input-group input:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .yt-playlist {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background: white;
        }
        
        .yt-item {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .yt-item:hover {
            background: var(--light);
        }
        
        .yt-item.active {
            background: var(--primary);
            color: white;
        }
        
        .yt-item-actions {
            display: flex;
            gap: 5px;
        }
        
        .icon-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }
        
        .icon-btn:hover {
            background: rgba(255,255,255,0.2);
        }
        
        /* Camera Section */
        .camera-section {
            margin-bottom: 30px;
        }
        
        .camera-preview {
            width: 100%;
            height: 200px;
            background: #333;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
            position: relative;
        }
        
        #cameraView {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .weight-input-group {
            margin-bottom: 15px;
        }
        
        .weight-input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--primary-dark);
        }
        
        .weight-input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .weight-input {
            flex: 1;
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .weight-input:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .weight-type-select {
            padding: 10px 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }
        
        .weight-type-select:focus {
            border-color: var(--primary);
            outline: none;
        }
        
        .photo-type-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .photo-type-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .photo-type-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .photo-type-btn:hover:not(.active) {
            background: var(--light);
        }
        
        .captured-images {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .captured-image-container {
            position: relative;
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .captured-image-container:hover {
            transform: scale(1.05);
        }
        
        .captured-image {
            width: 100%;
            height: 80px;
            object-fit: cover;
        }
        
        .image-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 4px 6px;
            font-size: 10px;
        }
        
        .image-weight {
            font-weight: bold;
            color: #FFD700;
        }
        
        /* Main Tracker Area */
        .tracker-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .tracker-header {
            padding: 15px 24px;
            background: white;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .month-selector {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .month-btn {
            padding: 8px 16px;
            background: var(--light);
            color: var(--primary-dark);
            border: 2px solid var(--primary);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .month-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        #currentMonth {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary-dark);
            min-width: 180px;
            text-align: center;
        }
        
        .tracker-container {
            flex: 1;
            overflow: auto;
            padding: 20px;
            background: #f9f9f9;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 14px;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        th, td {
            padding: 0;
            text-align: center;
            border: 1px solid #e0e0e0;
            height: 50px;
            box-sizing: border-box;
        }
        
        thead th {
            position: sticky;
            top: 0;
            background: var(--primary);
            font-weight: 600;
            color: white;
            z-index: 10;
        }
        
        .exercise-cell {
            position: sticky;
            left: 0;
            background: white;
            font-weight: 500;
            color: var(--dark);
            min-width: 200px;
            max-width: 200px;
            text-align: left;
            z-index: 9;
            border-right: 2px solid var(--primary);
            padding: 0 !important;
            background: var(--light);
        }
        
        .corner-cell {
            position: sticky;
            top: 0;
            left: 0;
            z-index: 11;
            background: var(--primary-dark);
            font-weight: 700;
            min-width: 200px;
            border-right: 2px solid var(--primary);
        }
        
        .day-header {
            padding: 10px 5px;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 60px;
        }
        
        .day-number {
            font-size: 14px;
            color: white;
            display: block;
            margin-top: 2px;
            font-weight: 700;
        }
        
        /* Weekend styling - Restored */
        .weekend-header {
            background: #E91E63 !important;
        }
        
        .weekend-cell {
            background: #FFF0F5 !important;
        }
        
        /* Exercise cell container styling */
        .habit-cell-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            height: 100%;
            padding: 0 15px;
            position: relative;
        }
        
        /* Exercise input styling */
        .exercise-input {
            flex: 1;
            width: 100%;
            border: none;
            background: transparent;
            font-family: inherit;
            font-size: 13px;
            color: var(--dark);
            outline: none;
            font-weight: 500;
            padding: 0;
            margin: 0;
        }
        
        .exercise-input:focus {
            color: var(--primary-dark);
        }
        
        /* Delete button styling - RED TEXT X on right edge */
        .delete-btn {
            background: none;
            color: #f44336; /* Red text color */
            border: none;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
            flex-shrink: 0;
            transition: all 0.2s ease;
            padding: 0;
            width: 24px;
            height: 24px;
            line-height: 1;
        }
        
        .delete-btn:hover {
            color: #d32f2f; /* Darker red on hover */
            transform: scale(1.2);
        }
        
        .delete-btn:active {
            transform: scale(0.95);
        }
        
        /* For the add new exercise row */
        .add-row .habit-cell-container {
            justify-content: flex-start;
        }
        
        .add-row .exercise-input {
            width: 100%;
        }
        
        .cell {
            width: 100%;
            height: 100%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s;
            position: relative;
        }
        
        .cell:hover {
            background-color: var(--light);
        }
        
        .cell.completed {
            background-color: #E8F5E9;
        }
        
        .cell.completed::after {
            content: '‚úì';
            color: var(--primary);
            font-size: 24px;
            font-weight: 700;
            position: absolute;
        }
        
        .cell.skipped {
            background-color: #FFEBEE;
        }
        
        .cell.skipped::after {
            content: '‚úó';
            color: var(--accent);
            font-size: 24px;
            font-weight: 700;
            position: absolute;
        }
        
        .cell.partial {
            background-color: #FFF3E0;
        }
        
        .cell.partial::after {
            content: '~';
            color: var(--secondary);
            font-size: 24px;
            font-weight: 700;
            position: absolute;
        }
        
        .cell-actions {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }
        
        /* Video Player Overlay - Full Screen */
        .video-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .video-overlay.active {
            display: flex;
        }
        
        .video-container {
            width: 90%;
            height: 80%;
            position: relative;
        }
        
        #fullScreenPlayer {
            width: 100%;
            height: 100%;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .video-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
        }
        
        .video-control-btn {
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .video-control-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }
        
        .video-control-btn.stop {
            background: var(--accent);
        }
        
        .video-control-btn.stop:hover {
            background: #D32F2F;
        }
        
        .close-video {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .close-video:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }
        
        /* YouTube Player Section - Hidden initially */
        .player-section {
            padding: 20px;
            background: white;
            border-top: 2px solid #e0e0e0;
            flex-shrink: 0;
            display: none;
        }
        
        .player-section.active {
            display: block;
        }
        
        .player-container {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        #player {
            flex: 1;
            height: 200px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .player-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            min-width: 150px;
        }
        
        .control-btn {
            padding: 10px 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }
        
        .control-btn:hover {
            background: var(--primary-dark);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
        }
        
        /* Start Video Button */
        .start-video-btn {
            margin-top: 15px;
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .start-video-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
        }
        
        /* Notification */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s, transform 0.3s;
            z-index: 1000;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }
        
        .modal-image-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        #modalImage {
            width: 100%;
            border-radius: 8px;
            display: block;
        }
        
        .image-info-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 12px 15px;
            font-size: 14px;
        }
        
        .image-info-title {
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 5px;
            color: #FFD700;
        }
        
        .image-weight-large {
            font-size: 20px;
            font-weight: bold;
            color: #FFD700;
        }
        
        .progress-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-item {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--primary);
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-dark);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .dashboard-panel {
                width: 300px;
            }
            
            .exercise-cell, .corner-cell {
                min-width: 180px;
                max-width: 180px;
            }
        }
        
        @media (max-width: 1024px) {
            .main-content {
                flex-direction: column;
            }
            
            .dashboard-panel {
                width: 100%;
                height: auto;
                max-height: 500px;
                border-right: none;
                border-bottom: 2px solid #e0e0e0;
            }
            
            .panel-content {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 20px;
                padding: 20px;
            }
            
            .goal-section {
                grid-column: 1 / -1;
            }
            
            .playlist-manager, .camera-section {
                margin-bottom: 0;
            }
            
            .player-container {
                flex-direction: column;
            }
            
            #player {
                width: 100%;
                height: 300px;
            }
            
            .video-container {
                width: 95%;
                height: 70%;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-wrap: wrap;
                padding: 12px 16px;
            }
            
            .controls {
                order: 3;
                width: 100%;
                margin-top: 10px;
                justify-content: center;
            }
            
            .tracker-header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .panel-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .day-header {
                min-width: 50px;
            }
            
            .video-container {
                width: 100%;
                height: 60%;
            }
            
            .video-controls {
                flex-wrap: wrap;
                justify-content: center;
                padding: 10px;
                width: 90%;
            }
            
            .progress-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-container">
                <div class="logo">BF</div>
                <div class="title-container">
                    <input type="text" class="title-input" id="pageTitle" value="üî• Belly Fat Burn Exercise Tracker" maxlength="50">
                </div>
            </div>
            <div class="controls">
                <button class="btn" id="clearMonthBtn">
                    <span>üóëÔ∏è</span> Clear Month
                </button>
                <button class="btn btn-secondary" id="addWorkoutBtn">
                    <span>‚ûï</span> Add Workout
                </button>
                <button class="btn" id="printBtn">
                    <span>üñ®Ô∏è</span> Print
                </button>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Dashboard Panel -->
            <div class="dashboard-panel">
                <div class="panel-header">
                    üìä Exercise Dashboard
                </div>
                <div class="panel-content">
                    <!-- Goal Section -->
                    <div class="goal-section">
                        <div class="goal-header">
                            <div class="goal-title">
                                <span>üéØ</span> My Goal / Why I Want to Lose Belly Fat
                            </div>
                            <button class="goal-edit-btn" id="editGoalBtn">
                                <span>‚úèÔ∏è</span> Edit
                            </button>
                        </div>
                        <div class="goal-text" id="goalText">
                            I want to lose belly fat to improve my health, feel more confident in my clothes, and have more energy to play with my kids. My target is to lose 15 pounds in 3 months!
                        </div>
                        <div class="goal-input-container" id="goalInputContainer" style="display: none;">
                            <textarea class="goal-input" id="goalInput" placeholder="Why do you want to lose belly fat? What are your goals? Write your motivation here..." maxlength="500"></textarea>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn" id="saveGoalBtn">Save Goal</button>
                                <button class="btn btn-secondary" id="cancelGoalBtn">Cancel</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- YouTube Playlist Manager -->
                    <div class="playlist-manager">
                        <div class="section-title">
                            <span>üì∫</span> YouTube Workout Playlist
                        </div>
                        <div class="yt-input-group">
                            <input type="text" id="ytUrlInput" placeholder="Paste YouTube video URL...">
                            <button class="btn" id="addYtBtn" style="width: 100%;">
                                <span>‚ûï</span> Add to Playlist
                            </button>
                        </div>
                        <div class="yt-playlist" id="ytPlaylist">
                            <!-- Playlist items will be added here -->
                        </div>
                        
                        <!-- Start Video Button -->
                        <button class="start-video-btn" id="startVideoBtn">
                            <span>‚ñ∂Ô∏è</span> START WORKOUT VIDEOS
                        </button>
                    </div>
                    
                    <!-- Camera Section -->
                    <div class="camera-section">
                        <div class="section-title">
                            <span>üì∑</span> Progress Photos & Weight
                        </div>
                        <div class="camera-preview">
                            <video id="cameraView" autoplay></video>
                        </div>
                        
                        <!-- Photo Type Selection -->
                        <div class="photo-type-buttons">
                            <button class="photo-type-btn active" id="beforeBtn" data-type="before">
                                üì∏ Before
                            </button>
                            <button class="photo-type-btn" id="progressBtn" data-type="progress">
                                üìä Progress
                            </button>
                            <button class="photo-type-btn" id="afterBtn" data-type="after">
                                üèÜ After
                            </button>
                        </div>
                        
                        <!-- Weight Input -->
                        <div class="weight-input-group">
                            <label for="weightInput">Weight (Optional):</label>
                            <div class="weight-input-container">
                                <input type="number" id="weightInput" class="weight-input" placeholder="Enter weight" step="0.1" min="0">
                                <select id="weightUnit" class="weight-type-select">
                                    <option value="lbs">lbs</option>
                                    <option value="kg">kg</option>
                                </select>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                            <button class="btn btn-secondary" id="startCameraBtn">
                                <span>üì∏</span> Start Camera
                            </button>
                            <button class="btn" id="captureBtn">
                                <span>‚≠ï</span> Capture Photo
                            </button>
                        </div>
                        
                        <!-- Captured Images -->
                        <div class="captured-images" id="capturedImages">
                            <!-- Captured images will appear here -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Tracker Area -->
            <div class="tracker-panel">
                <div class="tracker-header">
                    <div class="month-selector">
                        <button class="month-btn" id="prevMonth">&larr; Previous</button>
                        <div id="currentMonth">January 2023</div>
                        <button class="month-btn" id="nextMonth">Next &rarr;</button>
                    </div>
                    <div style="font-weight: 600; color: var(--primary);">
                        üéØ Daily Exercise Completion
                    </div>
                </div>
                
                <div class="tracker-container">
                    <table id="exerciseTable">
                        <thead id="monthHeader">
                            <!-- Days of the month will be generated by JavaScript -->
                        </thead>
                        <tbody id="exerciseBody">
                            <!-- Exercise rows will be generated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- YouTube Player Section (Hidden Initially) -->
        <div class="player-section" id="playerSection">
            <div class="player-container">
                <div id="player"></div>
                <div class="player-controls">
                    <button class="control-btn" id="playBtn">
                        <span>‚ñ∂Ô∏è</span> Play
                    </button>
                    <button class="control-btn" id="pauseBtn">
                        <span>‚è∏Ô∏è</span> Pause
                    </button>
                    <button class="control-btn" id="nextBtn">
                        <span>‚è≠Ô∏è</span> Next Video
                    </button>
                    <div class="checkbox-group">
                        <input type="checkbox" id="loopToggle" checked>
                        <label for="loopToggle">Loop Current Video</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="autoPlayToggle" checked>
                        <label for="autoPlayToggle">Auto-play Next</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Video Overlay (Full Screen) -->
    <div class="video-overlay" id="videoOverlay">
        <button class="close-video" id="closeVideoBtn">&times;</button>
        <div class="video-container">
            <div id="fullScreenPlayer"></div>
        </div>
        <div class="video-controls">
            <button class="video-control-btn" id="fsPlayBtn">
                <span>‚ñ∂Ô∏è</span> Play
            </button>
            <button class="video-control-btn" id="fsPauseBtn">
                <span>‚è∏Ô∏è</span> Pause
            </button>
            <button class="video-control-btn" id="fsNextBtn">
                <span>‚è≠Ô∏è</span> Next Video
            </button>
            <button class="video-control-btn stop" id="stopVideoBtn">
                <span>‚èπÔ∏è</span> Stop & Hide
            </button>
        </div>
    </div>
    
    <!-- Modal for Image View -->
    <div class="modal" id="imageModal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="modalTitle">Progress Photo</span>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="modal-image-container">
                <img id="modalImage" src="">
                <div class="image-info-overlay">
                    <div class="image-info-title" id="modalPhotoType"></div>
                    <div id="modalDate"></div>
                    <div>Weight: <span class="image-weight-large" id="modalWeight"></span></div>
                </div>
            </div>
            
            <!-- Progress Stats -->
            <div class="progress-stats" id="progressStats">
                <!-- Stats will be populated dynamically -->
            </div>
            
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-danger" id="deleteImageBtn">Delete Photo</button>
            </div>
        </div>
    </div>
    
    <!-- Notification -->
    <div id="notification" class="notification">Saved</div>

    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
    
    <script>
        // Initialize current date
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        
        // Exercise data for belly fat burn - EXPANDED LIST
        let exercises = [
            "Plank (60 sec)",
            "Mountain Climbers (30 reps)",
            "Russian Twists (20 reps)",
            "Leg Raises (15 reps)",
            "Bicycle Crunches (30 reps)",
            "Side Plank (30 sec each)",
            "Burpees (10 reps)",
            "Jumping Jacks (50 reps)",
            "High Knees (60 sec)",
            "Flutter Kicks (30 reps)",
            "Heel Touches (20 reps)",
            "Scissor Kicks (30 reps)",
            "Sit-ups (15 reps)",
            "V-Ups (10 reps)",
            "Toe Touches (20 reps)",
            "Reverse Crunches (15 reps)",
            "Cobra Stretch (30 sec)",
            "Superman (30 sec)",
            "Dead Bug (20 reps)",
            "Bird Dog (15 reps each)",
            "Hollow Hold (30 sec)",
            "Bear Crawl (60 sec)",
            "Inchworm (10 reps)",
            "Wall Sit (60 sec)",
            "Squats (20 reps)",
            "Lunges (15 reps each)",
            "Push-ups (10 reps)",
            "Tricep Dips (15 reps)",
            "Glute Bridges (20 reps)"
        ];
        
        // YouTube playlist data
        let youtubePlaylist = [];
        let currentVideoIndex = 0;
        let player;
        let fullScreenPlayer;
        
        // Camera and images
        let cameraStream = null;
        let capturedImages = [];
        let currentPhotoType = "before"; // "before", "progress", or "after"
        
        // Goal/Motivation data
        let userGoal = "";
        
        // Load saved data
        let exerciseData = JSON.parse(localStorage.getItem('exerciseData')) || {};
        let savedTitle = localStorage.getItem('exerciseTitle') || "üî• Belly Fat Burn Exercise Tracker";
        let savedPlaylist = JSON.parse(localStorage.getItem('youtubePlaylist')) || [];
        let savedImages = JSON.parse(localStorage.getItem('progressImages')) || [];
        let savedGoal = localStorage.getItem('userGoal') || "I want to lose belly fat to improve my health, feel more confident in my clothes, and have more energy to play with my kids. My target is to lose 15 pounds in 3 months!";
        
        // Initialize
        document.getElementById('pageTitle').value = savedTitle;
        youtubePlaylist = savedPlaylist;
        capturedImages = savedImages;
        userGoal = savedGoal;
        
        // Update goal display
        function updateGoalDisplay() {
            const goalText = document.getElementById('goalText');
            if (userGoal.trim()) {
                goalText.textContent = userGoal;
                goalText.classList.remove('empty');
            } else {
                goalText.textContent = "Click 'Edit' to set your goal and motivation for losing belly fat...";
                goalText.classList.add('empty');
            }
        }
        
        // Generate the exercise tracker
        function generateExerciseTracker() {
            const monthHeader = document.getElementById('monthHeader');
            const exerciseBody = document.getElementById('exerciseBody');
            
            // Clear previous content
            monthHeader.innerHTML = '';
            exerciseBody.innerHTML = '';
            
            // Update month display
            const monthNames = ["January", "February", "March", "April", "May", "June",
                                "July", "August", "September", "October", "November", "December"];
            document.getElementById('currentMonth').textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            // Get days in current month
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Create table header with days of the month
            const headerRow = document.createElement('tr');
            
            // Corner cell (top-left)
            const cornerCell = document.createElement('th');
            cornerCell.textContent = 'Exercises';
            cornerCell.classList.add('corner-cell');
            headerRow.appendChild(cornerCell);
            
            // Create day headers
            for (let day = 1; day <= daysInMonth; day++) {
                const dayHeader = document.createElement('th');
                dayHeader.classList.add('day-header');
                
                // Get day name
                const dayOfWeek = new Date(currentYear, currentMonth, day).getDay();
                const dayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
                
                dayHeader.innerHTML = `<div>${dayNames[dayOfWeek]}</div><div class="day-number">${day}</div>`;
                
                // Add weekend styling
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayHeader.classList.add('weekend-header');
                }
                
                headerRow.appendChild(dayHeader);
            }
            
            monthHeader.appendChild(headerRow);
            
            // Create exercise rows
            exercises.forEach((exercise, exerciseIndex) => {
                createExerciseRow(exercise, exerciseIndex, daysInMonth);
            });
            
            // Add the "add new exercise" row at the bottom
            addNewExerciseRow(daysInMonth);
            
            // Update YouTube playlist display
            updatePlaylistDisplay();
            
            // Update captured images display
            updateImagesDisplay();
            
            // Update goal display
            updateGoalDisplay();
        }
        
        // Create an exercise row
        function createExerciseRow(exerciseName, exerciseIndex, daysInMonth) {
            const exerciseBody = document.getElementById('exerciseBody');
            const exerciseRow = document.createElement('tr');
            
            // Exercise name cell (editable)
            const exerciseNameCell = document.createElement('td');
            exerciseNameCell.classList.add('exercise-cell');
            
            const cellContainer = document.createElement('div');
            cellContainer.classList.add('habit-cell-container');
            
            const exerciseInput = document.createElement('input');
            exerciseInput.type = 'text';
            exerciseInput.classList.add('exercise-input');
            exerciseInput.value = exerciseName;
            exerciseInput.setAttribute('data-exercise-index', exerciseIndex);
            exerciseInput.setAttribute('maxlength', '40');
            
            exerciseInput.addEventListener('blur', function() {
                const index = parseInt(this.getAttribute('data-exercise-index'));
                const newName = this.value.trim();
                
                if (newName && newName !== exercises[index]) {
                    exercises[index] = newName;
                    saveExerciseData();
                    showNotification('Exercise updated');
                } else if (!newName) {
                    this.value = exercises[index];
                }
            });
            
            exerciseInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    this.blur();
                }
            });
            
            // Delete button - RED TEXT X on right edge
            const deleteBtn = document.createElement('button');
            deleteBtn.classList.add('delete-btn');
            deleteBtn.innerHTML = '√ó';
            deleteBtn.setAttribute('data-exercise-index', exerciseIndex);
            deleteBtn.setAttribute('title', 'Delete exercise');
            
            deleteBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                const index = parseInt(this.getAttribute('data-exercise-index'));
                const exerciseName = exercises[index];
                
                if (confirm(`Delete "${exerciseName}"?`)) {
                    exercises.splice(index, 1);
                    
                    // Remove all data for this exercise
                    const monthKey = `${currentYear}-${currentMonth}`;
                    Object.keys(exerciseData).forEach(key => {
                        if (key.startsWith(`${monthKey}-${index}`)) {
                            delete exerciseData[key];
                        }
                        // Update indices for exercises after the deleted one
                        else if (key.startsWith(`${monthKey}-`)) {
                            const parts = key.split('-');
                            const exerciseIdx = parseInt(parts[2]);
                            if (exerciseIdx > index) {
                                const newKey = `${parts[0]}-${parts[1]}-${exerciseIdx-1}-${parts[3]}`;
                                exerciseData[newKey] = exerciseData[key];
                                delete exerciseData[key];
                            }
                        }
                    });
                    
                    saveExerciseData();
                    generateExerciseTracker();
                    showNotification('Exercise deleted');
                }
            });
            
            cellContainer.appendChild(exerciseInput);
            cellContainer.appendChild(deleteBtn);
            exerciseNameCell.appendChild(cellContainer);
            exerciseRow.appendChild(exerciseNameCell);
            
            // Create cells for each day
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('td');
                const dayOfWeek = new Date(currentYear, currentMonth, day).getDay();
                
                // Add weekend styling
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayCell.classList.add('weekend-cell');
                }
                
                const cellDiv = document.createElement('div');
                cellDiv.classList.add('cell');
                cellDiv.setAttribute('data-exercise-index', exerciseIndex);
                cellDiv.setAttribute('data-day', day);
                
                // Create unique key for this exercise/day/month/year
                const key = `${currentYear}-${currentMonth}-${exerciseIndex}-${day}`;
                
                // Check exercise status
                if (exerciseData[key] === 'completed') {
                    cellDiv.classList.add('completed');
                } else if (exerciseData[key] === 'skipped') {
                    cellDiv.classList.add('skipped');
                } else if (exerciseData[key] === 'partial') {
                    cellDiv.classList.add('partial');
                }
                
                // Add click events
                cellDiv.addEventListener('click', function(e) {
                    if (e.shiftKey) {
                        // Shift+click to mark as skipped
                        toggleExerciseStatus(this, 'skipped');
                    } else if (e.altKey) {
                        // Alt+click to mark as partial
                        toggleExerciseStatus(this, 'partial');
                    } else {
                        // Regular click to mark as completed
                        toggleExerciseStatus(this, 'completed');
                    }
                });
                
                // Add context menu for additional options
                cellDiv.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    showCellContextMenu(this, e.clientX, e.clientY);
                });
                
                dayCell.appendChild(cellDiv);
                exerciseRow.appendChild(dayCell);
            }
            
            exerciseBody.appendChild(exerciseRow);
        }
        
        function toggleExerciseStatus(cell, status) {
            const exerciseIdx = parseInt(cell.getAttribute('data-exercise-index'));
            const dayNum = parseInt(cell.getAttribute('data-day'));
            const cellKey = `${currentYear}-${currentMonth}-${exerciseIdx}-${dayNum}`;
            
            // Remove all status classes
            cell.classList.remove('completed', 'skipped', 'partial');
            
            if (cellDataExists(cellKey) && exerciseData[cellKey] === status) {
                // If clicking the same status, remove it
                delete exerciseData[cellKey];
            } else {
                // Set new status
                cell.classList.add(status);
                exerciseData[cellKey] = status;
            }
            
            saveExerciseData();
        }
        
        function cellDataExists(key) {
            return exerciseData[key] !== undefined;
        }
        
        function showCellContextMenu(cell, x, y) {
            // Create context menu
            const menu = document.createElement('div');
            menu.style.position = 'fixed';
            menu.style.left = x + 'px';
            menu.style.top = y + 'px';
            menu.style.background = 'white';
            menu.style.border = '1px solid #ddd';
            menu.style.borderRadius = '6px';
            menu.style.boxShadow = '0 2px 10px rgba(0,0,0,0.1)';
            menu.style.zIndex = '1000';
            menu.style.minWidth = '150px';
            
            const options = [
                { text: '‚úÖ Mark as Completed', action: 'completed' },
                { text: '‚ùå Mark as Skipped', action: 'skipped' },
                { text: '‚ö†Ô∏è Mark as Partial', action: 'partial' },
                { text: 'üóëÔ∏è Clear Status', action: 'clear' }
            ];
            
            options.forEach(option => {
                const item = document.createElement('div');
                item.style.padding = '10px 15px';
                item.style.cursor = 'pointer';
                item.style.borderBottom = '1px solid #eee';
                item.textContent = option.text;
                
                item.addEventListener('click', () => {
                    if (option.action === 'clear') {
                        const exerciseIdx = parseInt(cell.getAttribute('data-exercise-index'));
                        const dayNum = parseInt(cell.getAttribute('data-day'));
                        const cellKey = `${currentYear}-${currentMonth}-${exerciseIdx}-${dayNum}`;
                        
                        cell.classList.remove('completed', 'skipped', 'partial');
                        delete exerciseData[cellKey];
                        saveExerciseData();
                    } else {
                        toggleExerciseStatus(cell, option.action);
                    }
                    document.body.removeChild(menu);
                });
                
                item.addEventListener('mouseenter', () => {
                    item.style.background = '#f5f5f5';
                });
                
                item.addEventListener('mouseleave', () => {
                    item.style.background = 'white';
                });
                
                menu.appendChild(item);
            });
            
            document.body.appendChild(menu);
            
            // Close menu when clicking elsewhere
            setTimeout(() => {
                const closeMenu = (e) => {
                    if (!menu.contains(e.target)) {
                        document.body.removeChild(menu);
                        document.removeEventListener('click', closeMenu);
                    }
                };
                document.addEventListener('click', closeMenu);
            }, 100);
        }
        
        // Add new exercise row
        function addNewExerciseRow(daysInMonth) {
            const exerciseBody = document.getElementById('exerciseBody');
            const addRow = document.createElement('tr');
            addRow.classList.add('add-row');
            
            const exerciseNameCell = document.createElement('td');
            exerciseNameCell.classList.add('exercise-cell');
            
            const cellContainer = document.createElement('div');
            cellContainer.classList.add('habit-cell-container');
            
            const exerciseInput = document.createElement('input');
            exerciseInput.type = 'text';
            exerciseInput.classList.add('exercise-input');
            exerciseInput.placeholder = 'Add new exercise...';
            
            exerciseInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && this.value.trim()) {
                    const newExercise = this.value.trim();
                    exercises.push(newExercise);
                    
                    saveExerciseData();
                    generateExerciseTracker();
                    showNotification('Exercise added');
                    
                    setTimeout(() => {
                        const newInput = document.querySelector(`input[data-exercise-index="${exercises.length - 1}"]`);
                        if (newInput) {
                            newInput.focus();
                            newInput.select();
                        }
                    }, 100);
                }
            });
            
            cellContainer.appendChild(exerciseInput);
            exerciseNameCell.appendChild(cellContainer);
            addRow.appendChild(exerciseNameCell);
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('td');
                const dayOfWeek = new Date(currentYear, currentMonth, day).getDay();
                
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dayCell.classList.add('weekend-cell');
                }
                
                const placeholder = document.createElement('div');
                placeholder.classList.add('cell');
                placeholder.style.opacity = '0.3';
                
                const placeholderText = document.createElement('span');
                placeholderText.textContent = '+';
                placeholderText.style.color = '#ccc';
                placeholderText.style.fontSize = '12px';
                
                placeholder.appendChild(placeholderText);
                dayCell.appendChild(placeholder);
                addRow.appendChild(dayCell);
            }
            
            exerciseBody.appendChild(addRow);
        }
        
        // YouTube Playlist Functions
        function extractVideoId(url) {
            const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[7].length === 11) ? match[7] : null;
        }
        
        function addYouTubeVideo(url) {
            const videoId = extractVideoId(url);
            if (!videoId) {
                showNotification('Invalid YouTube URL');
                return;
            }
            
            const videoItem = {
                id: videoId,
                url: url,
                title: `Workout Video ${youtubePlaylist.length + 1}`,
                added: new Date().toISOString()
            };
            
            youtubePlaylist.push(videoItem);
            updatePlaylistDisplay();
            savePlaylistData();
            showNotification('Video added to playlist');
        }
        
        function updatePlaylistDisplay() {
            const playlistEl = document.getElementById('ytPlaylist');
            playlistEl.innerHTML = '';
            
            youtubePlaylist.forEach((video, index) => {
                const item = document.createElement('div');
                item.classList.add('yt-item');
                if (index === currentVideoIndex) {
                    item.classList.add('active');
                }
                
                item.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span>${index + 1}.</span>
                        <span style="flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                            ${video.title}
                        </span>
                    </div>
                    <div class="yt-item-actions">
                        <button class="icon-btn" data-index="${index}" title="Delete">
                            üóëÔ∏è
                        </button>
                    </div>
                `;
                
                playlistEl.appendChild(item);
            });
            
            // Add event listeners for delete buttons
            document.querySelectorAll('.yt-item-actions button').forEach(btn => {
                const index = parseInt(btn.getAttribute('data-index'));
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    removeYouTubeVideo(index);
                });
            });
            
            // Add click to select video
            document.querySelectorAll('.yt-item').forEach(item => {
                item.addEventListener('click', function() {
                    const index = Array.from(this.parentNode.children).indexOf(this);
                    loadYouTubeVideo(index);
                });
            });
        }
        
        function removeYouTubeVideo(index) {
            youtubePlaylist.splice(index, 1);
            if (currentVideoIndex >= index) {
                currentVideoIndex = Math.max(0, currentVideoIndex - 1);
            }
            updatePlaylistDisplay();
            savePlaylistData();
            
            if (youtubePlaylist.length > 0) {
                loadYouTubeVideo(currentVideoIndex);
            } else {
                // Clear player if no videos
                if (player) {
                    player.stopVideo();
                }
                if (fullScreenPlayer) {
                    fullScreenPlayer.stopVideo();
                }
            }
        }
        
        function loadYouTubeVideo(index) {
            if (index >= 0 && index < youtubePlaylist.length) {
                currentVideoIndex = index;
                if (player) {
                    player.loadVideoById(youtubePlaylist[index].id);
                }
                if (fullScreenPlayer) {
                    fullScreenPlayer.loadVideoById(youtubePlaylist[index].id);
                }
                updatePlaylistDisplay();
            }
        }
        
        // YouTube Player
        function onYouTubeIframeAPIReady() {
            // Regular player (hidden initially)
            player = new YT.Player('player', {
                height: '200',
                width: '100%',
                playerVars: {
                    'autoplay': 0,
                    'controls': 1,
                    'rel': 0,
                    'showinfo': 0
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
            
            // Full screen player
            fullScreenPlayer = new YT.Player('fullScreenPlayer', {
                height: '100%',
                width: '100%',
                playerVars: {
                    'autoplay': 1,
                    'controls': 1,
                    'rel': 0,
                    'showinfo': 0,
                    'modestbranding': 1
                },
                events: {
                    'onReady': onFullScreenPlayerReady,
                    'onStateChange': onFullScreenPlayerStateChange
                }
            });
        }
        
        function onPlayerReady(event) {
            if (youtubePlaylist.length > 0) {
                event.target.loadVideoById(youtubePlaylist[0].id);
            }
        }
        
        function onFullScreenPlayerReady(event) {
            if (youtubePlaylist.length > 0) {
                event.target.loadVideoById(youtubePlaylist[currentVideoIndex].id);
            }
        }
        
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.ENDED) {
                const loopToggle = document.getElementById('loopToggle').checked;
                const autoPlayToggle = document.getElementById('autoPlayToggle').checked;
                
                if (loopToggle) {
                    event.target.playVideo();
                } else if (autoPlayToggle && currentVideoIndex < youtubePlaylist.length - 1) {
                    loadYouTubeVideo(currentVideoIndex + 1);
                }
            }
        }
        
        function onFullScreenPlayerStateChange(event) {
            if (event.data === YT.PlayerState.ENDED) {
                const loopToggle = document.getElementById('loopToggle').checked;
                const autoPlayToggle = document.getElementById('autoPlayToggle').checked;
                
                if (loopToggle) {
                    event.target.playVideo();
                } else if (autoPlayToggle && currentVideoIndex < youtubePlaylist.length - 1) {
                    loadYouTubeVideo(currentVideoIndex + 1);
                }
            }
        }
        
        // Camera Functions
        async function startCamera() {
            try {
                cameraStream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'user', width: 640, height: 480 }
                });
                const cameraView = document.getElementById('cameraView');
                cameraView.srcObject = cameraStream;
                showNotification('Camera started');
            } catch (err) {
                console.error('Camera error:', err);
                showNotification('Camera access denied');
            }
        }
        
        function captureImage() {
            if (!cameraStream) {
                showNotification('Start camera first');
                return;
            }
            
            const cameraView = document.getElementById('cameraView');
            const canvas = document.createElement('canvas');
            canvas.width = cameraView.videoWidth;
            canvas.height = cameraView.videoHeight;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(cameraView, 0, 0, canvas.width, canvas.height);
            
            const imageData = canvas.toDataURL('image/jpeg', 0.8);
            
            const weightInput = document.getElementById('weightInput').value;
            const weightUnit = document.getElementById('weightUnit').value;
            
            const imageItem = {
                data: imageData,
                date: new Date().toISOString(),
                type: currentPhotoType,
                weight: weightInput ? parseFloat(weightInput) : null,
                unit: weightUnit,
                month: `${currentMonth}-${currentYear}`
            };
            
            capturedImages.unshift(imageItem); // Add to beginning
            if (capturedImages.length > 12) {
                capturedImages = capturedImages.slice(0, 12); // Keep only 12 images
            }
            
            // Clear weight input
            document.getElementById('weightInput').value = '';
            
            updateImagesDisplay();
            saveImagesData();
            showNotification(`${currentPhotoType.charAt(0).toUpperCase() + currentPhotoType.slice(1)} photo captured`);
        }
        
        function updateImagesDisplay() {
            const imagesContainer = document.getElementById('capturedImages');
            imagesContainer.innerHTML = '';
            
            capturedImages.forEach((image, index) => {
                const container = document.createElement('div');
                container.classList.add('captured-image-container');
                container.setAttribute('data-index', index);
                
                const img = document.createElement('img');
                img.src = image.data;
                img.classList.add('captured-image');
                
                // Create overlay with info
                const overlay = document.createElement('div');
                overlay.classList.add('image-overlay');
                
                const typeLabel = image.type.charAt(0).toUpperCase() + image.type.slice(1);
                const date = new Date(image.date);
                const dateStr = `${date.getMonth()+1}/${date.getDate()}/${date.getFullYear()}`;
                
                let weightText = '';
                if (image.weight !== null) {
                    weightText = `<span class="image-weight">${image.weight}${image.unit}</span>`;
                }
                
                overlay.innerHTML = `
                    <div>${typeLabel}</div>
                    <div>${dateStr} ${weightText}</div>
                `;
                
                container.appendChild(img);
                container.appendChild(overlay);
                container.addEventListener('click', () => openImageModal(index));
                
                imagesContainer.appendChild(container);
            });
        }
        
        function openImageModal(index) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const modalTitle = document.getElementById('modalTitle');
            const modalPhotoType = document.getElementById('modalPhotoType');
            const modalDate = document.getElementById('modalDate');
            const modalWeight = document.getElementById('modalWeight');
            const progressStats = document.getElementById('progressStats');
            const deleteBtn = document.getElementById('deleteImageBtn');
            
            const image = capturedImages[index];
            modalImage.src = image.data;
            
            const date = new Date(image.date);
            const dateStr = `${date.toLocaleDateString('en-US', { weekday: 'long' })}, ${date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}`;
            
            const typeLabel = image.type.charAt(0).toUpperCase() + image.type.slice(1);
            modalTitle.textContent = `${typeLabel} Progress Photo`;
            modalPhotoType.textContent = `${typeLabel} Photo`;
            modalDate.textContent = dateStr;
            
            if (image.weight !== null) {
                modalWeight.textContent = `${image.weight} ${image.unit}`;
            } else {
                modalWeight.textContent = 'Not recorded';
            }
            
            // Calculate and display progress stats
            updateProgressStats(progressStats, index);
            
            deleteBtn.onclick = () => {
                capturedImages.splice(index, 1);
                saveImagesData();
                updateImagesDisplay();
                modal.style.display = 'none';
                showNotification('Photo deleted');
            };
            
            modal.style.display = 'flex';
        }
        
        function updateProgressStats(container, currentIndex) {
            const currentImage = capturedImages[currentIndex];
            container.innerHTML = '';
            
            // Get all images of the same type
            const sameTypeImages = capturedImages.filter(img => img.type === currentImage.type);
            
            if (sameTypeImages.length > 1) {
                // Find oldest and newest of this type
                sameTypeImages.sort((a, b) => new Date(a.date) - new Date(b.date));
                const oldest = sameTypeImages[0];
                const newest = sameTypeImages[sameTypeImages.length - 1];
                
                if (oldest.weight !== null && newest.weight !== null) {
                    const weightDiff = newest.weight - oldest.weight;
                    const diffText = weightDiff > 0 ? `+${weightDiff}` : weightDiff;
                    const diffColor = weightDiff < 0 ? 'green' : weightDiff > 0 ? 'red' : 'gray';
                    
                    container.innerHTML = `
                        <div class="stat-item">
                            <div class="stat-label">Starting Weight</div>
                            <div class="stat-value">${oldest.weight} ${oldest.unit}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Current Weight</div>
                            <div class="stat-value">${newest.weight} ${newest.unit}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Weight Change</div>
                            <div class="stat-value" style="color: ${diffColor}">${diffText} ${newest.unit}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Time Period</div>
                            <div class="stat-value">${calculateTimePeriod(oldest.date, newest.date)}</div>
                        </div>
                    `;
                } else {
                    container.innerHTML = `
                        <div class="stat-item">
                            <div class="stat-label">Photos Taken</div>
                            <div class="stat-value">${sameTypeImages.length} ${currentImage.type} photos</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">First Photo</div>
                            <div class="stat-value">${new Date(oldest.date).toLocaleDateString()}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Latest Photo</div>
                            <div class="stat-value">${new Date(newest.date).toLocaleDateString()}</div>
                        </div>
                    `;
                }
            } else {
                container.innerHTML = `
                    <div class="stat-item">
                        <div class="stat-label">Photo Type</div>
                        <div class="stat-value">${currentImage.type.charAt(0).toUpperCase() + currentImage.type.slice(1)}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Date Taken</div>
                        <div class="stat-value">${new Date(currentImage.date).toLocaleDateString()}</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Total Photos</div>
                        <div class="stat-value">${capturedImages.length} photos total</div>
                    </div>
                `;
            }
        }
        
        function calculateTimePeriod(startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            const diffTime = Math.abs(end - start);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays < 30) {
                return `${diffDays} days`;
            } else if (diffDays < 365) {
                const months = Math.floor(diffDays / 30);
                return `${months} month${months !== 1 ? 's' : ''}`;
            } else {
                const years = Math.floor(diffDays / 365);
                const remainingMonths = Math.floor((diffDays % 365) / 30);
                let result = `${years} year${years !== 1 ? 's' : ''}`;
                if (remainingMonths > 0) {
                    result += `, ${remainingMonths} month${remainingMonths !== 1 ? 's' : ''}`;
                }
                return result;
            }
        }
        
        // Goal Functions
        function editGoal() {
            document.getElementById('goalText').style.display = 'none';
            document.getElementById('goalInputContainer').style.display = 'block';
            document.getElementById('goalInput').value = userGoal;
            document.getElementById('goalInput').focus();
        }
        
        function saveGoal() {
            const newGoal = document.getElementById('goalInput').value.trim();
            userGoal = newGoal;
            localStorage.setItem('userGoal', userGoal);
            
            document.getElementById('goalInputContainer').style.display = 'none';
            document.getElementById('goalText').style.display = 'block';
            updateGoalDisplay();
            showNotification('Goal saved');
        }
        
        function cancelGoalEdit() {
            document.getElementById('goalInputContainer').style.display = 'none';
            document.getElementById('goalText').style.display = 'block';
        }
        
        // Video Control Functions
        function startWorkoutVideos() {
            if (youtubePlaylist.length === 0) {
                showNotification('Add videos to playlist first');
                return;
            }
            
            // Show video overlay in full screen
            document.getElementById('videoOverlay').classList.add('active');
            
            // Load the first video
            loadYouTubeVideo(currentVideoIndex);
            
            // Play the video
            setTimeout(() => {
                if (fullScreenPlayer) {
                    fullScreenPlayer.playVideo();
                }
            }, 1000);
        }
        
        function stopAndHideVideos() {
            // Stop video
            if (fullScreenPlayer) {
                fullScreenPlayer.stopVideo();
            }
            
            // Hide video overlay
            document.getElementById('videoOverlay').classList.remove('active');
            
            // Show notification
            showNotification('Workout stopped');
        }
        
        // Save functions
        function saveExerciseData() {
            localStorage.setItem('exerciseData', JSON.stringify(exerciseData));
            localStorage.setItem('exerciseList', JSON.stringify(exercises));
            localStorage.setItem('exerciseTitle', document.getElementById('pageTitle').value);
        }
        
        function savePlaylistData() {
            localStorage.setItem('youtubePlaylist', JSON.stringify(youtubePlaylist));
        }
        
        function saveImagesData() {
            localStorage.setItem('progressImages', JSON.stringify(capturedImages));
        }
        
        // Show notification
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }
        
        // Event Listeners
        document.getElementById('prevMonth').addEventListener('click', function() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            generateExerciseTracker();
        });
        
        document.getElementById('nextMonth').addEventListener('click', function() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            generateExerciseTracker();
        });
        
        document.getElementById('clearMonthBtn').addEventListener('click', function() {
            if (confirm('Clear all exercise data for this month?')) {
                const monthKey = `${currentYear}-${currentMonth}`;
                Object.keys(exerciseData).forEach(key => {
                    if (key.startsWith(monthKey)) {
                        delete exerciseData[key];
                    }
                });
                
                saveExerciseData();
                generateExerciseTracker();
                showNotification('Month cleared');
            }
        });
        
        document.getElementById('addWorkoutBtn').addEventListener('click', function() {
            const input = document.querySelector('.add-row .exercise-input');
            if (input) {
                input.focus();
            }
        });
        
        document.getElementById('printBtn').addEventListener('click', function() {
            window.print();
        });
        
        document.getElementById('addYtBtn').addEventListener('click', function() {
            const urlInput = document.getElementById('ytUrlInput');
            if (urlInput.value.trim()) {
                addYouTubeVideo(urlInput.value.trim());
                urlInput.value = '';
            }
        });
        
        // Goal section event listeners
        document.getElementById('editGoalBtn').addEventListener('click', editGoal);
        document.getElementById('saveGoalBtn').addEventListener('click', saveGoal);
        document.getElementById('cancelGoalBtn').addEventListener('click', cancelGoalEdit);
        
        // Photo type buttons
        document.querySelectorAll('.photo-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                // Remove active class from all buttons
                document.querySelectorAll('.photo-type-btn').forEach(b => {
                    b.classList.remove('active');
                });
                // Add active class to clicked button
                this.classList.add('active');
                // Update current photo type
                currentPhotoType = this.getAttribute('data-type');
            });
        });
        
        document.getElementById('startCameraBtn').addEventListener('click', startCamera);
        document.getElementById('captureBtn').addEventListener('click', captureImage);
        
        // Start Video Button
        document.getElementById('startVideoBtn').addEventListener('click', startWorkoutVideos);
        
        // Regular player controls
        document.getElementById('playBtn').addEventListener('click', function() {
            if (player) {
                player.playVideo();
            }
        });
        
        document.getElementById('pauseBtn').addEventListener('click', function() {
            if (player) {
                player.pauseVideo();
            }
        });
        
        document.getElementById('nextBtn').addEventListener('click', function() {
            if (currentVideoIndex < youtubePlaylist.length - 1) {
                loadYouTubeVideo(currentVideoIndex + 1);
            } else {
                loadYouTubeVideo(0);
            }
        });
        
        // Full screen player controls
        document.getElementById('fsPlayBtn').addEventListener('click', function() {
            if (fullScreenPlayer) {
                fullScreenPlayer.playVideo();
            }
        });
        
        document.getElementById('fsPauseBtn').addEventListener('click', function() {
            if (fullScreenPlayer) {
                fullScreenPlayer.pauseVideo();
            }
        });
        
        document.getElementById('fsNextBtn').addEventListener('click', function() {
            if (currentVideoIndex < youtubePlaylist.length - 1) {
                loadYouTubeVideo(currentVideoIndex + 1);
            } else {
                loadYouTubeVideo(0);
            }
        });
        
        document.getElementById('stopVideoBtn').addEventListener('click', stopAndHideVideos);
        document.getElementById('closeVideoBtn').addEventListener('click', stopAndHideVideos);
        
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('imageModal').style.display = 'none';
        });
        
        document.getElementById('pageTitle').addEventListener('input', function() {
            localStorage.setItem('exerciseTitle', this.value);
        });
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('imageModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
            
            const videoOverlay = document.getElementById('videoOverlay');
            if (event.target === videoOverlay) {
                stopAndHideVideos();
            }
        });
        
        // Initialize
        generateExerciseTracker();
        
        // Load saved data
        const savedExercises = JSON.parse(localStorage.getItem('exerciseList'));
        if (savedExercises && savedExercises.length > 0) {
            exercises = savedExercises;
            generateExerciseTracker();
        }
        
        // Auto-focus title if empty
        if (!savedTitle) {
            setTimeout(() => {
                document.getElementById('pageTitle').focus();
            }, 300);
        }
        
        // Handle window resize
        window.addEventListener('resize', function() {
            // Update layout if needed
        });
        
        // Add sample YouTube videos if playlist is empty
        if (youtubePlaylist.length === 0) {
            const sampleVideos = [
                'https://www.youtube.com/watch?v=ml6cT4AZdqI', // 10 min abs workout
                'https://www.youtube.com/watch?v=AnYl6Nk9GOA', // 15 min HIIT
                'https://www.youtube.com/watch?v=4pKly2JojMw'  // 20 min belly fat
            ];
            
            setTimeout(() => {
                sampleVideos.forEach(video => {
                    addYouTubeVideo(video);
                });
                showNotification('Sample workout videos added');
            }, 1000);
        }
        
        // Add sample weight and progress data if no images exist
        if (capturedImages.length === 0) {
            // Add sample before photo
            const sampleBeforeDate = new Date();
            sampleBeforeDate.setDate(sampleBeforeDate.getDate() - 30);
            
            capturedImages.push({
                data: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=300&fit=crop',
                date: sampleBeforeDate.toISOString(),
                type: 'before',
                weight: 185,
                unit: 'lbs',
                month: `${currentMonth}-${currentYear}`
            });
            
            // Add sample progress photo
            const sampleProgressDate = new Date();
            sampleProgressDate.setDate(sampleProgressDate.getDate() - 15);
            
            capturedImages.push({
                data: 'https://images.unsplash.com/photo-1594381898411-846e7d193883?w=400&h=300&fit=crop',
                date: sampleProgressDate.toISOString(),
                type: 'progress',
                weight: 178,
                unit: 'lbs',
                month: `${currentMonth}-${currentYear}`
            });
            
            // Add sample after photo
            capturedImages.push({
                data: 'https://images.unsplash.com/photo-1534367507877-0edd93bd013b?w=400&h=300&fit=crop',
                date: new Date().toISOString(),
                type: 'after',
                weight: 172,
                unit: 'lbs',
                month: `${currentMonth}-${currentYear}`
            });
            
            saveImagesData();
            updateImagesDisplay();
        }
    </script>
</body>
</html>
